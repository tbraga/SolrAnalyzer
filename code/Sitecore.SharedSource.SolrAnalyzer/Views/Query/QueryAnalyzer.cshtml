@model Sitecore.SharedSource.SolrAnalyzer.Models.IStatisticsBoard

@{
    Layout = "~/Views/Query/SolrAnalyzerLayout.cshtml";
}

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<style>
    
    .chosen-rtl .chosen-drop { left: -9000px; }

    .ui-autocomplete-loading {
         background: white url("images/ui-anim_basic_16x16.gif") right center no-repeat;
     }

    .ui-widget-header {
        background-color: #4286f4;
    }

    .slider-range, .filter {
        margin-left: 5px;
        margin-right: 5px;
        margin-top: 5px;
    }

    body {
        font-family: Arial, Helvetica, sans-serif;
    }

    table {
        font-size: 1em;
    }

    .ui-draggable, .ui-droppable {
        background-position: top;
    }

    .emotion-items {
        margin: 15px;
    }

    .emotion-item {
        margin-bottom: 15px;
    }

    .emotion-item input {
        text-align: center;
    }

    .filter-title, .filter-value {
        font-weight: bold;
    }

    .section-title {
        padding-left: 2px;
        height: 35px;
        font-weight: bold;
        background-color: #f0f0f0;
        border-bottom: 1px solid #cccccc;
        border-top: 1px solid #cccccc;
        line-height: 35px;
        vertical-align: middle;
    }

    .cognitiveSearchButton {
        margin-right: 15px;
        float: right;
    }
</style>

<script src="/sitecore modules/Web/SolrAnalyzer/js/Sitecore.SharedSource.SolrAnalyzer.js"></script>

<h1 class="modal-heading">Solr Analyzer : Query Analyzer</h1>
<div class="frame">
    <div class="rte-search-form">
        <form class="form image-search-form">
            <div class="search-results">
                <div id="content">
                    <div id="metrics-query-analysis" ng-class="showAllStacktraces ? 'expanded' : 'collapsed'" class="ng-scope collapsed">
                        <div class="page-content">
                            <div class="page-title">Description:</div>
                            <div class="page-summary">
                                This page will analyze the performance of the queries that have been running against Solr.  Each query is an HTTP call and has a consequence in
                                downloading the requested data.  Try to tune your queries to be lean, this will help in downloading a smaller amount of data while applying the
                                same intended value.  You will also save on bandwidth between the server and the requestor.
                            </div>
                            <div class="page-title">Keep in mind:</div>
                            <div class="page-summary">
                                <ul>
                                    <li>
                                        Select only the fields on the document you need for your scenario.  If you only need 10 of the 50 fields for a specific query only call those 10,
                                        this will reduce the amount of bytes during the response download.
                                    </li>
                                    <li>
                                        Make sure you are only requesting the number of documents you need by using the ROWS parameter within your request.  If you need to paginate you
                                        can use the ROWS parameter in combination with the START parameter.
                                    </li>
                                    <li>
                                        Caching: Optimize the document cache on each of your heavily utilized cores.  Specifically look at the eviction rate and the hit ratio.
                                    </li>
                                    <li>
                                        By running the query through the Chrome browser, you can look at the network tab of Chrome's Developer Tools and see the byte size returned from Solr
                                        as well as the response time.  Getting these two numbers to perform are key to a well optimized environment.
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <table id="query-analysis" class="ng-scope">
                        <thead>
                            <tr>
                                <th><b>Query</b></th>
                                <th><b>Rows Requested</b></th>
                                <th><b>Number of Documents Found</b></th>
                                <th><b>Number of Documents Returned</b></th>
                                <th><b>Time in MS</b></th>
                                <th><b>Payload in Bytes</b></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><a href="/solr/cognitive_master_index/select?q=*:*&amp;indent=on&amp;tim=5&amp;rows=5&amp;wt=xml" target="_blank" title="*:*">*:*</a></td><td>5</td><td>771</td><td>5</td><td>14</td><td>28166</td></tr>
                            <tr><td><a href="/solr/cognitive_master_index/select?q=*:*&amp;indent=on&amp;tim=6&amp;rows=5&amp;wt=xml" target="_blank" title="*:*">*:*</a></td><td>5</td><td>771</td><td>5</td><td>8</td><td>28166</td></tr>
                            <tr><td><a href="/solr/cognitive_master_index/select?q=*:*&amp;indent=on&amp;tim=7&amp;rows=5&amp;wt=xml" target="_blank" title="*:*">*:*</a></td><td>5</td><td>771</td><td>5</td><td>5</td><td>28166</td></tr>
                            <tr><td><a href="/solr/cognitive_master_index/select?q=*:*&amp;indent=on&amp;tim=8&amp;rows=5&amp;wt=xml" target="_blank" title="*:*">*:*</a></td><td>5</td><td>771</td><td>5</td><td>4</td><td>28166</td></tr>
                            <tr class="query-analysis-totals">
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                                <td id="totDocsReturned" style="color: red; font-weight: bold;">@Model.TotalNumDocsReturned</td>
                                <td id="totTime" style="color: red; font-weight: bold;">@Model.TotalTime</td>
                                <td id="totBytes" style="color: red; font-weight: bold;">@Model.TotalPayload</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="scWizardButtons">
                <button class="form-cancel scButton">Close</button>
            </div>
        </form>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js" type="text/javascript"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
</div>